# -*- coding: utf-8 -*-
"""EDA1.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1Swyr3QhKdi_OLtoOo0HoaqaqV_YrD9q9
"""

# EXPLORATORY DATA ANALYSIS (EDA) ON CARDIOGRAPHIC DATASET
# 1. Import Required Libraries
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from scipy import stats

# Set visualization style
sns.set(style="whitegrid", palette="coolwarm")
plt.rcParams['figure.figsize'] = (8, 5)

# 2. Load the Dataset
# Replace the path with your uploaded dataset location in Colab
df = pd.read_csv("Cardiotocographic.csv")

# Preview dataset
print("✅ Dataset successfully loaded.\n")
print("First 5 rows of dataset:")
display(df.head())

print("\nDataset Info:")
df.info()

print("\nShape of dataset:", df.shape)

# 3. Data Cleaning & Preparation

# Check for missing values
print("\nMissing Values per Column:")
print(df.isnull().sum())

# If any missing values exist, fill numeric ones with mean/median
num_cols = df.select_dtypes(include=[np.number]).columns
df[num_cols] = df[num_cols].apply(lambda x: x.fillna(x.median()))

# Check for duplicates
duplicates = df.duplicated().sum()
print(f"\nNumber of duplicate rows: {duplicates}")
if duplicates > 0:
    df.drop_duplicates(inplace=True)

# Convert data types if needed
print("\nChecking data types:")
print(df.dtypes)

# 4. Outlier Detection & Treatment
print("\nOutlier Detection (Using Z-score method):")

z_scores = np.abs(stats.zscore(df[num_cols]))
outliers = (z_scores > 3).sum()
print("Outliers per column:\n", pd.Series(outliers, index=num_cols))

# Optional: You can remove them if needed
# df = df[(z_scores < 3).all(axis=1)]

# 5. Statistical Summary
print("\nStatistical Summary:")
summary = df.describe().T
display(summary)

# Add IQR for better dispersion understanding
Q1 = df[num_cols].quantile(0.25)
Q3 = df[num_cols].quantile(0.75)
IQR = Q3 - Q1
iqr_table = pd.DataFrame({'Q1': Q1, 'Q3': Q3, 'IQR': IQR})
print("\nInterquartile Range (IQR):")
display(iqr_table)

# 6. Data Visualization

# --- 6.1 Histograms ---
df[num_cols].hist(bins=15, figsize=(14, 10), color='skyblue', edgecolor='black')
plt.suptitle('Distribution of Numerical Variables', fontsize=16)
plt.show()

# --- 6.2 Boxplots for Outlier Visualization ---
plt.figure(figsize=(14, 8))
sns.boxplot(data=df[num_cols], orient='h')
plt.title('Boxplots of Numerical Features', fontsize=14)
plt.show()

# --- 6.3 Correlation Heatmap ---
corr_matrix = df.corr()
plt.figure(figsize=(10, 6))
sns.heatmap(corr_matrix, annot=True, cmap="coolwarm", fmt=".2f")
plt.title("Correlation Heatmap", fontsize=14)
plt.show()

# --- 6.4 Pair Plot ---
sns.pairplot(df[num_cols].sample(200) if len(df) > 200 else df[num_cols])
plt.suptitle('Pairplot of Numerical Variables', y=1.02)
plt.show()

# --- 6.5 Violin Plots (for Distribution + Outliers) ---
for col in num_cols[:5]:
    plt.figure(figsize=(7, 4))
    sns.violinplot(y=df[col], color='lightblue')
    plt.title(f'Violin Plot - {col}')
    plt.show()

# 7. Pattern Recognition & Insights
print("\nPattern Recognition and Insights:")
strong_corr = corr_matrix[(corr_matrix > 0.7) & (corr_matrix < 1.0)]
print("\nStrong Positive Correlations (r > 0.7):\n")
print(strong_corr.dropna(how='all').dropna(axis=1, how='all'))

weak_corr = corr_matrix[(corr_matrix < -0.7)]
print("\nStrong Negative Correlations (r < -0.7):\n")
print(weak_corr.dropna(how='all').dropna(axis=1, how='all'))

# 8. Conclusion
print("\nConclusion Summary:")
print("""
✔ The dataset has been cleaned and validated; no major missing values or type errors found.
✔ Basic descriptive statistics reveal the central tendencies and dispersion of fetal heart parameters.
✔ Correlation heatmap helps identify relationships between variables like LB, ASTV, and ALTV.
✔ Some variables exhibit mild outliers, visible in boxplots and violin plots.
✔ Pairplot and heatmap provide insights into inter-variable relationships — useful for feature selection.
✔ These findings can guide future predictive modeling for fetal health monitoring.
""")